(function(f){var e={responseType:"json",showProgress:function(b,d){},progressFallback:function(){},onAbort:function(){},responseHandlers:{200:function(b){},400:function(b){},fallback:function(b){}}},g={submiter:function(b){var d=f(this);d.find(":input");var c=new XMLHttpRequest;b.preventDefault();c.upload?c.upload.addEventListener("progress",g.onprogress,!1):d.onprogress=g.onprogress;c.onreadystatechange=function(){if(4==c.readyState){var a="json"==e.responseType?f.parseJSON(c.responseText):c.responseText;
if(e.responseHandlers[c.status])e.responseHandlers[c.status](a);else e.responseHandlers.fallback(a)}};c.onabort=e.onAbort();c.open("POST",d.attr("action"),!0);if(window.FormData)c.send(new FormData(this));else if(window.File&&window.FileList&&(c.sendAsBinary||window.Uint8Array)){var l="----"+g.randomstring(8)+"----",m=d.find(":input").filter('[type!="file"]'),d=d.find('input[type="file"]');b=d.length;var a="";m.each(function(){a+="--"+l+"\r\n";a+='Content-disposition: form-data; name="'+f(this).attr("name")+
'"\r\n\r\n'+f(this).val()+"\r\n"});for(m=0;m<b;m++){var h=f(d[m]),n=h[0].files,p=n.length;if(0!=p)if(1==p){var k=n[0];k&&(a+="--"+l+"\r\n",a+='Content-disposition: form-data; name="'+h.attr("name")+'"; filename="'+unescape(encodeURIComponent(g.getfilename(k)))+'"\r\n',a+="Content-Type: application/octet-stream\r\n",a+="Content-Transfer-Encoding: binary\r\n\r\n",a+=g.readFileSynchronously(k),a+="\r\n")}else{for(var q="--"+g.randomstring(10)+"--",a=a+("--"+l+"\r\n"),a=a+('Content-disposition: form-data; name="'+
h.attr("name")+'";\r\n'),a=a+("Content-type: multipart/mixed; boundary="+q+"\r\n\r\n"),h=0;h<p;h++)k=n[h],a+="--"+q+"\r\n",a+='Content-disposition: attachment; filename="'+unescape(encodeURIComponent(g.getfilename(k)))+'"\r\n',a+="Content-Type: application/octet-stream\r\n",a+="Content-Transfer-Encoding: binary\r\n\r\n",a+=g.readFileSynchronously(k),a+="\r\n";a+="--"+q+"--\r\n"}}a+="--"+l+"--\r\n";c.setRequestHeader("Content-type","multipart/form-data; boundary="+l);c.sendAsBinary||(XMLHttpRequest.prototype.sendAsBinary=
function(a){a=Array.prototype.map.call(a,function(a){return a.charCodeAt(0)&255});a=new Uint8Array(a);this.send(a.buffer)});c.sendAsBinary(a)}else f.ajax({type:"POST",data:f(this).serialize(),dataType:"json"==e.responseType?"json":"html",url:f(this).attr("action"),success:function(a){e.responseHandlers[200](a)},error:function(a,b,c){a="json"==e.responseType?f.parseJSON(a.responseText):a.responseText;e.responseHandlers.fallback(a)}})},onprogress:function(b){b.lengthComputable?e.showProgress(b.loaded,
b.total):e.progressFallback()},randomstring:function(b){for(var d="",c=0;c<b;c++)d+="._-+*#0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*b)];return d},getfilename:function(b){return b.name||b.fileName},readFileSynchronously:function(b){if(window.FileReader){var d=new FileReader,c=function(){2!=d.readyState&&setTimeout(function(){c()},100)};d.readAsBinaryString(b);c();return d.result}if(b.getAsBinary)return b.getAsBinary()}};f.fn.superAjaxForm=function(b){e=
f.extend(e,b);return this.each(function(){f(this).on("submit.superAjaxForm",g.submiter)})}})(jQuery);
